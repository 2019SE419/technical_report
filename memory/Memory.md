## Memory

### Introduction 

在计算机中，存储器是指存储信息供计算机立即使用的计算机硬件集成电路；它是术语“主存储器”的同义词。计算机存储器以高速运行，例如随机存取存储器（RAM），这与提供慢存取信息但提供更高容量的存储器不同。如果需要，计算机内存的内容可以传输到辅助存储器；一种非常常见的方法是通过一种称为“虚拟内存”的内存管理技术。存储器是一个古老的同义词。

### Key Indicators



- **容量**：内存容量指该内存条的存储容量，是内存条的关键性参数，一般都是2的整数次方。

- **频率**：内存频率是指内存主频，即内存所能达到的最高工作频率，有两种表示方法，分别是工作频率和等效频率，工作频率是内存颗粒实际的工作频率，等效频率不同，DDR内存等效频率是工作频率的两倍，DDR2等效频率是工作频率的四倍，因为DDR内存在脉冲的上升和下降都传输数据，而DDR2内存每个时钟能够以四倍于工作频率的速度运行。频率也可以看作传输标准，传输标准也是内存速度的参数，传输标准是内存的规范，如果内存采用了此传输标准就说明完全符合该规范，所以传输标准也代表着该内存的速度。

- **电压**：内存正常工作运行时所需要的电压值极为电压，内存电压并不是固定值，不同类型的内存额定电压值有所区别，但是都有自己各自允许的范围，如略微提高内存的电压，虽然有利于内存超频，但是会增加发热量，损坏硬件的风险会大大增加。

- **金手指**：金手指由一定数量金黄色的金属片排列如手指状组成，金属片表面镀金，所以称为金手指，它是主机与内存条之间的连接部分，也是系统数据传输的中介部位。金手指制作工艺复杂，因为金的传导性、抗氧化性很强，在覆铜板上通过特殊工艺在覆上一层金箔，但是因为黄金价格昂贵，现在大都采用镀锡技术，只有部分高端机器的配件接触点还继续采用镀金的做法，但是价格高昂。

- **颗粒封装**：颗粒封装时将内存芯片封裹起来，以避免芯片与外界接触，防止空气中的颗粒和气体对内存芯片上的电路的精密性造成破坏而导致电学性能下降，封装技术类型不同对内存性能的发挥也起到至关重要的作用。

- **内存带宽**：如果我们把内存看作是内存控制器与中央处理器之间的仓库和桥梁，内存控制器一般嵌入在北桥芯片内，很显然，内存容量代表了仓库容量，内存的带宽则决定了桥梁的宽度，这就是内存容量与内存速度的区别。此外，决定内存性能另一关键参数还有延时周期，延时周期是中央处理器需要读取内存中的数据时，CPU会发出一个要求由内存控制器先执行，该要求从中央处理器到内存控制器，内存再回到中央处理器所需的时间。所以，提高内存速度的关键方法之一是缩短延时周期。为了缩短延时周期，缓冲区就此诞生，在实际应用中，中央处理器中的一级缓存L1与二级缓存L2是内存与中央处理之间大桥的小桥，由于L1与L2均采取静态随机存取的原理，我们可将其理解为内存带宽，或者FSB（前端总线），所以内存带宽与前端总线之间有着非常密切的关系。

  - 计算带宽的方法：

  ```
  总线位数x时钟频率x倍增系数/8=内存带宽
  ```

  例如DDR400内存，其数据总线位数是64位，运行频率是200MHz，倍增系数是2，此时带宽为200x64x2/8=3.2GB/s。

  - 由于运行效率几乎无法成倍提升，提高内存带宽的有效方式便是提高数据总线位数与倍增系数。

  - DDR3内存的主要努力目标就是提高内存带宽，并且为前端总线FSB越来越高的CPU提供强力的匹配指标。DDR3达到了高带宽、低功耗，核心工作电压降至1.5V，功耗比DDR2节省30%，发热量也在可控范围内。

    | 比较参数        | DDR2    | DDR3     |
    | --------------- | ------- | -------- |
    | 最高频率        | 1066M   | 533M     |
    | 带宽            | 8.5GB/s | 4.26GB/s |
    | 封装            | TSOP II | FBGA等   |
    | 最高物理Bank    | 8       | 4        |
    | 最高逻辑Bank    | 8       | 4        |
    | 数据预取（bit） | 4       | 2        |
    | 工作电压        | 1.8V    | 2.5V     |

  - 通过两种类型内存的各种参数比较，DDR2的工作电压比DDR低了大约三分之一，而功耗也少了一半，并且DDR2模组尺寸减小很多，信号更加完整，各模块之间的空气流动空间更大，且有良好的散热性能和可靠性，因此更容易达到最高的频率。
  - DDR4内存有基于Single-endedSignaling信号技术和基于差分信号技术的两种规格，其中基于差分信号技术的DDR4内存其传输速率则将可以达到6.4Gbps，而使用SE信号的DDR4内存其传输速率也被确认为1.6～3.2Gbps，DDR4内存将同时存在基于传统SE信号和差分信号的两种规格产品，因为不可能通过一个DRAM实现两种接口。

- **CL设置**：因为CPU运行速度大大超过内存数据传输速度，因此大多数情况下CPU要向内存读取所需的原始数据时，CPU都需要等待内存提供数据，内存传输速度越慢，CPU等待时间越长，对硬件系统整体性能影响就越大，任何类型的内存，在传输数据之前，传输双方必须要进行必要的通信，这个动作会延迟数据传输，CL设置一定程度上表示了内存在CPU接到读取内存数据的指令后，到正式开始读区内存数据所需的等待时间，因此，CL设置低就具有速度优势。一般情况下，速度不同的内存混插在系统内，系统会以设置较慢的速度来运行，所以我们应选择CL设置相同的内存，避免造成资源浪费。

### Instances

#### AMD-nForce2平台

AthlonXP平台向更高端的前端总线发展，nForce2芯片组功不可没，通常情况下，内存频率直接决定了内存带宽，但是经过测试在nForce2芯片组中不同，因为内存控制器的特殊要求，DDR内存与CPU同步时才能达到最高频率。

设定CPU频率为166MHz，前端总线为333MHz，DDR运行与DDR333情况下，其总体性能输出要比CPU设定为166MHz、DDR运行于DDR400模式的方案更为优越，因此，多数情况下，建议nForce2用户将内存频率Memory Frequency设置为同步Sync。

在没有集成显卡的SPP北桥上，单通道与双通道内存的性能输出差距非常小，但是在使用集成显卡的IGP北桥中，双通道内存的优势明显，其具有强大的输出能力。尽管双通道内存在nForce2平台上可提高内存带宽，但是无法发挥出前端总线FSB优势，只需单通道DDR内存即可满足要求。因此，nForce2能领先KT400，内存控制器的效率是关键，并非双通道技术。

#### Intel-I865PE平台

I865PE芯片组完全解决了内存带宽的瓶颈，凭借双通道DDR技术，把P4处理器动力发挥到了极致。将P4处理器运行于800MHz前端总线，得到以下结果：

|              | 前端总线频率/工作频率 | 最高带宽 |
| :----------: | :-------------------: | :------: |
|   Pentium4   |        400MHz         | 3.2GB/s  |
|   Pentium4   |          533          |   4.2    |
|   Pentium4   |          800          |   6.4    |
| 双通道DDR400 |          400          |   6.4    |
|    DDR400    |          400          |   3.4    |
| 双通道DDR333 |          333          |   5.4    |
|    DDR333    |          333          |   2.7    |
| 双通道DDR266 |          266          |   4.2    |
|    DDR266    |          266          |   2.1    |



